<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <title>ì¸ íŒë³„ê¸°</title>
    <link href="https://fonts.googleapis.com/css?family=Nanum+Gothic+Coding:400" rel="stylesheet">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Nanum Gothic Coding', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background-color: #f9f9f9;
        }

        .hidden {
            display: none;
        }

        h1,
        label,
        input,
        button,
        #result {
            text-align: center;
        }

        #formArea {
            display: none;
            margin-top: 20px;
            width: 100%;
            max-width: 400px;
        }

        button {
            padding: 10px 20px;
            font-size: 1em;
            margin: 5px;
            cursor: pointer;
        }

        #result {
            margin-top: 30px;
            font-size: 1.2em;
            font-weight: bold;
        }
    </style>
</head>

<body>

    <!-- ì²« í™”ë©´: ì‹œì‘í•˜ê¸° ë²„íŠ¼ë§Œ ë³´ì„ -->
    <div id="welcome">
        <button onclick="showSetup()">ì‹œì‘í•˜ê¸°</button>
    </div>

    <!-- ìˆ¨ê²¨ì§„ ì„¤ì • ì˜ì—­ -->
    <div id="setup" class="hidden">
        <h1>ì¸ íŒë³„ê¸°</h1>
        <label>ì§€ê¸ˆê¹Œì§€ ëª‡ ë²ˆì„ ë§Œë‚¬ë‚˜ìš”?</label>
        <input type="number" id="loopCount"><br>
        <button onclick="start()">ë‹¤ìŒ</button>
    </div>

    <div id="formArea"></div>
    <div id="result"></div>

    <script>
        let count = 0;
        let heart = 0;

        function showSetup() {
            document.getElementById("welcome").style.display = "none";
            document.getElementById("setup").classList.remove("hidden");
        }

        function drunk(count, alcohol, add_people) {
            if (alcohol === 'Yes' || alcohol === 'yes') {
                count += 1;
                if (add_people === 'Yes' || add_people === 'yes') {
                    count -= 1;
                } else {
                    count += 1;
                }
            }
            return count;
        }

        function YesOrNo(count) {
            return count > 2 ? 1 : 0;
        }

        function success(heart) {
            if (heart === 1) {
                return "ğŸ‰ ì¶•í•˜í•©ë‹ˆë‹¤. ì¸ì…ë‹ˆë‹¤. ì•ìœ¼ë¡œ ì²˜ì‹  ì˜ í•˜ì‹­ì‹œì˜¤.";
            } else {
                return "ğŸ˜¢ ë‹¤ìŒ ê¸°íšŒê°€ ìˆì„ ê²ƒì…ë‹ˆë‹¤...";
            }
        }

        function promise(count, time) {
            if (time > 3) {
                count += 1;
                if (time > 7) {
                    count += 1;
                }
            } else {
                count -= 1;
            }
            return count;
        }

        function selectOption(id, value) {
            document.getElementById(id).value = value;

            // ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì—…ë°ì´íŠ¸
            const parent = document.getElementById(id).parentElement;
            const buttons = parent.querySelectorAll("button");
            buttons.forEach(btn => {
                btn.style.backgroundColor = (btn.textContent === value) ? "#4CAF50" : "";
                btn.style.color = (btn.textContent === value) ? "white" : "";
            });
        }

        function start() {
            const loop = parseInt(document.getElementById("loopCount").value);
            const formArea = document.getElementById("formArea");
            formArea.innerHTML = '';
            formArea.style.display = 'block';

            for (let i = 0; i < loop; i++) {
                formArea.innerHTML += `
      <h3>${i + 1}ë²ˆì§¸ ë§Œë‚¨</h3>
      <label>ì•½ì† ì‹œê°„ (ì‹œê°„):</label>
      <input type="number" id="time${i}">

      <label>ë‹¨ ë‘˜ì´ ìˆ ì„ ë§ˆì…¨ë‚˜ìš”? (Yes/No):</label>
      <div>
        <button type="button" onclick="selectOption('alcohol${i}', 'Yes')">Yes</button>
        <button type="button" onclick="selectOption('alcohol${i}', 'No')">No</button>
        <input type="hidden" id="alcohol${i}">
      </div>

      <label>ë‹¤ìŒ ì•½ì† ì¡ì•˜ë‚˜ìš”? (Yes/No):</label>
      <div>
        <button type="button" onclick="selectOption('next${i}', 'Yes')">Yes</button>
        <button type="button" onclick="selectOption('next${i}', 'No')">No</button>
        <input type="hidden" id="next${i}">
      </div>

      <label>ê·¸ ì•½ì†ì— ë‹¤ë¥¸ ì‚¬ëŒ ìˆë‚˜ìš”? (Yes/No):</label>
      <div>
        <button type="button" onclick="selectOption('add_people${i}', 'Yes')">Yes</button>
        <button type="button" onclick="selectOption('add_people${i}', 'No')">No</button>
        <input type="hidden" id="add_people${i}">
      </div>
      <br><br>
    `;
            }

            // âœ… ì•ˆì „í•œ ë°©ì‹ìœ¼ë¡œ ë²„íŠ¼ ì¶”ê°€
            const evalBtn = document.createElement("button");
            evalBtn.textContent = "ê²°ê³¼ ë³´ê¸°";
            evalBtn.onclick = () => evaluate(loop);
            formArea.appendChild(evalBtn);
        }


        function evaluate(loop) {
            count = 0;
            for (let i = 0; i < loop; i++) {
                const timeInput = document.getElementById(`time${i}`);
                const alcohol = document.getElementById(`alcohol${i}`).value;
                const next = document.getElementById(`next${i}`).value;
                const add_people = document.getElementById(`add_people${i}`).value;

                const time = parseInt(timeInput.value);
                if (isNaN(time) || alcohol === '' || next === '' || add_people === '') {
                    alert(`${i + 1}ë²ˆì§¸ ë§Œë‚¨ì˜ ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”.`);
                    return;
                }

                if (next === 'Yes' || next === 'yes') {
                    count = drunk(count, alcohol, add_people);
                }
                count = promise(count, time);
            }

            heart = YesOrNo(count);
            const resultText = success(heart);
            document.getElementById("result").innerHTML = `<h2>${resultText}</h2>`;
            alert(resultText);  // âœ… ê²°ê³¼ë¥¼ ì•Œë¦¼ì°½ìœ¼ë¡œë„ ë³´ì—¬ì¤Œ
        }


    </script>
</body>

</html>
